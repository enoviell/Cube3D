NAME = cub3D
OS = $(shell uname)
TEXT = TEXT=1

MAIN = $(wildcard srcs/main/*.c)
RAY = $(wildcard srcs/raycast/*.c)
UTILS = $(wildcard srcs/utils/*.c)
MAPS = $(wildcard maps/*.cub)

SRCS = $(RAY) $(UTILS) $(MAIN)
HDRS = includes
LIBS = $(wildcard includes/*.h)
MAKEFLAGS += --silent
OBJ = $(SRCS:.c=.o)
CC = gcc
CFLAGS = -Wall -Wextra -Werror -g -O3
RM = rm -rf

RED = "\\033[91m"
GREEN = "\\033[92m"
YELLOW = "\\033[93m"
BLUE = "\\033[94m"
PURPLE =  "\\033[95m"
CYAN = "\\033[96m"
BLANK = "\\033[0m"
SEP = "***********************************************************"

%.o: %.c
	@if [ $(OS) = "Darwin" ]; then\
		$(CC) -g -Imlx -O3 -I ${HDRS} -c $< -o $@;\
	else\
		$(CC) $(CFLAGS) -g -I/usr/includesude -Imlx_linux -I ${HDRS} -c $< -o $@;\
	fi

$(NAME): $(OBJ)

	@echo "\033[38;2;66;130;240m████████████████████████████████████████████████████████████████████████████████████████████████\033[0m"
	@echo "\033[38;2;66;131;241m█░░░░░░░░░░░░░░█░░░░░░██░░░░░░█░░░░░░░░░░░░░░███░░░░░░░░░░░░░░████░░░░░░░░░░░░░░█░░░░░░░░░░░░███\033[0m"
	@echo "\033[38;2;66;132;242m█░░▄▀▄▀▄▀▄▀▄▀░░█░░▄▀░░██░░▄▀░░█░░▄▀▄▀▄▀▄▀▄▀░░███░░▄▀▄▀▄▀▄▀▄▀░░████░░▄▀▄▀▄▀▄▀▄▀░░█░░▄▀▄▀▄▀▄▀░░░░█\033[0m"
	@echo "\033[38;2;66;133;243m█░░▄▀░░░░░░░░░░█░░▄▀░░██░░▄▀░░█░░▄▀░░░░░░▄▀░░███░░▄▀░░░░░░░░░░████░░░░░░░░░░▄▀░░█░░▄▀░░░░▄▀▄▀░░█\033[0m"
	@echo "\033[38;2;66;134;244m█░░▄▀░░█████████░░▄▀░░██░░▄▀░░█░░▄▀░░██░░▄▀░░███░░▄▀░░████████████████████░░▄▀░░█░░▄▀░░██░░▄▀░░█\033[0m"
	@echo "\033[38;2;66;135;245m█░░▄▀░░█████████░░▄▀░░██░░▄▀░░█░░▄▀░░░░░░▄▀░░░░█░░▄▀░░░░░░░░░░████░░░░░░░░░░▄▀░░█░░▄▀░░██░░▄▀░░█\033[0m"
	@echo "\033[38;2;66;136;246m█░░▄▀░░█████████░░▄▀░░██░░▄▀░░█░░▄▀▄▀▄▀▄▀▄▀▄▀░░█░░▄▀▄▀▄▀▄▀▄▀░░████░░▄▀▄▀▄▀▄▀▄▀░░█░░▄▀░░██░░▄▀░░█\033[0m"
	@echo "\033[38;2;66;137;247m█░░▄▀░░█████████░░▄▀░░██░░▄▀░░█░░▄▀░░░░░░░░▄▀░░█░░▄▀░░░░░░░░░░████░░░░░░░░░░▄▀░░█░░▄▀░░██░░▄▀░░█\033[0m"
	@echo "\033[38;2;66;138;248m█░░▄▀░░█████████░░▄▀░░██░░▄▀░░█░░▄▀░░████░░▄▀░░█░░▄▀░░████████████████████░░▄▀░░█░░▄▀░░██░░▄▀░░█\033[0m"
	@echo "\033[38;2;66;139;249m█░░▄▀░░░░░░░░░░█░░▄▀░░░░░░▄▀░░█░░▄▀░░░░░░░░▄▀░░█░░▄▀░░░░░░░░░░████░░░░░░░░░░▄▀░░█░░▄▀░░░░▄▀▄▀░░█\033[0m"
	@echo "\033[38;2;66;140;250m█░░▄▀▄▀▄▀▄▀▄▀░░█░░▄▀▄▀▄▀▄▀▄▀░░█░░▄▀▄▀▄▀▄▀▄▀▄▀░░█░░▄▀▄▀▄▀▄▀▄▀░░████░░▄▀▄▀▄▀▄▀▄▀░░█░░▄▀▄▀▄▀▄▀░░░░█\033[0m"
	@echo "\033[38;2;66;141;251m█░░░░░░░░░░░░░░█░░░░░░░░░░░░░░█░░░░░░░░░░░░░░░░█░░░░░░░░░░░░░░████░░░░░░░░░░░░░░█░░░░░░░░░░░░███\033[0m"
	@echo "\033[38;2;66;142;252m████████████████████████████████████████████████████████████████████████████████████████████████\033[0m"

	@if [ $(OS) = "Darwin" ]; then\
		make mac;\
	else\
		make linux;\
	fi

	@echo "$(GREEN)$(NAME) compiled succesfully.$(PURPLE)"
	@echo "$(SEP)$(BLANK)"

all: $(NAME)

linux:
	@echo "Compiling $(BLUE)Linux$(YELLOW) mlx...\n"
	@(make -C ./mlx_linux) 2> /dev/null
	@echo "\n\n"
	@gcc -g $(OBJ) -Lmlx_linux -lmlx_Linux -L/usr/lib -Imlx_linux -lXext -lX11 -lm -lz -D LIN=1 -o $(NAME)

clean:
	@echo "$(RED)Cleaning..."
	@(${RM} $(OBJ))
	@make -C ./mlx_linux/ clean
	@echo "$(BLANK)"

fclean: clean
	@(${RM} $(NAME) ${OBJ})

re: clean $(NAME)
